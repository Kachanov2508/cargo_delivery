<style>
    #order_form {
        position: relative;
        width: 100%;
        height: 100%;
        background-color: #ccc;
        transition: all 1s ease;
        z-index: 999;
    }

    .order_form__left {
    }

    .order_form__right {
        width: 100%;
        height: 100%;
        position: absolute;
        z-index: 998;
        top: 0;
        left: 0;
        background-color: #cccccc;
        animation: show_map .5s ease;
        transform: translateX(100%)
    }

    .order_form__close {
        position: absolute;
        top: 5px;
        right: 5px;
        font-size: 25px;
        transition: all .3s ease;
        cursor: pointer;
    }

    .order_form__close:hover {
        color: #f7f7f7;
    }

    @keyframes show_map {
        0% {
            opacity: 0;
            transform: translateX(0);
        }
        100% {
            opacity: 1;
            transform: translateX(100%);
        }
    }

    #map {
        width: 100%;
        height: 100%;
    }
</style>

<div id="order_form">
    <div class="order_form__left">
        <form method="post">
            {% csrf_token %}
            <!-- Откуда -->
            <div class="form-floating" id="floatingFrom" @click="show_map">
                <select class="form-select" aria-label="Floating label select example">
                    <option selected>Подольск</option>
                    <option value="1">Владимир</option>
                    <option value="2">Нижний Новгород</option>
                    <option value="3">Чебоксары</option>
                    <option value="3">Казань</option>
                </select>
                <label for="floatingFrom">Откуда</label>
            </div>

            <!-- Куда -->
            <div class="form-floating mt-3" id="floatingWhere" @click="show_map">
                <select class="form-select" aria-label="Floating label select example">
                    <option selected>Подольск</option>
                    <option value="1">Владимир</option>
                    <option value="2">Нижний Новгород</option>
                    <option value="3">Чебоксары</option>
                    <option value="3">Казань</option>
                </select>
                <label for="floatingWhere">Куда</label>
            </div>

            <!-- Имя -->
            <div class="form-floating mt-3" @click="show_map">
                <input type="text" class="form-control" id="floatingName" placeholder="Имя">
                <label for="floatingName">Имя</label>
            </div>

            <!-- Телефон -->
            <div class="form-floating mt-3" @click="show_map">
                <input type="tel" class="form-control" id="floatingPhone" placeholder="Телефон">
                <label for="floatingPhone">Телефон</label>
            </div>

            <!-- Email -->
            <div class="form-floating mt-3" @click="show_map">
                <input type="email" class="form-control" id="floatingEmail" placeholder="email">
                <label for="floatingEmail">Email</label>
            </div>

            <!-- Отправить -->
            <div class="d-grid mt-3">
                <button class="btn btn-primary btn-lg">Рассчитать</button>
            </div>
        </form>
    </div>

    <div class="order_form__right" :class="{ order_form__right_active: visible }" v-show="visible">
        <!-- Яндекс карта -->
        <div id="map"></div>

        <!-- Кнопка закрыть -->
        <div class="order_form__close" @click="close_map">
            <i class="bi bi-x-circle"></i>
        </div>
    </div>
</div>

<script>
    const Yandex_map = {
        delimiters: ["[[", "]]"],
        data() {
            return {
                visible: false,
            }
        },
        methods: {
            show_map() {
                this.visible = true
            },
            close_map() {
                this.visible = false
            },
            init() {
                // Стоимость за километр.
                const DELIVERY_TARIFF = 20,
                    // Минимальная стоимость.
                    MINIMUM_COST = 500,
                    myMap = new ymaps.Map('map', {
                        center: [60.906882, 30.067233],
                        zoom: 9,
                        controls: []
                    });

                    // Создадим панель маршрутизации.
                    routePanelControl = new ymaps.control.RoutePanel({
                        options: {
                            // Добавим заголовок панели.
                            showHeader: true,
                            title: 'Расчёт доставки'
                        }
                    });

                    const zoomControl = new ymaps.control.ZoomControl({
                        options: {
                            size: 'small',
                            float: 'none',
                            position: {
                                bottom: 145,
                                right: 10
                            }
                        }
                    });

                // Пользователь сможет построить только автомобильный маршрут.
                routePanelControl.routePanel.options.set({
                    types: {auto: true}
                });

                // Если вы хотите задать неизменяемую точку "откуда", раскомментируйте код ниже.
                /*routePanelControl.routePanel.state.set({
                    fromEnabled: false,
                    from: 'Москва, Льва Толстого 16'
                 });*/

                myMap.controls.add(routePanelControl).add(zoomControl);

                // Получим ссылку на маршрут.
                routePanelControl.routePanel.getRouteAsync().then(function (route) {

                    // Зададим максимально допустимое число маршрутов, возвращаемых мультимаршрутизатором.
                    route.model.setParams({results: 1}, true);

                    // Повесим обработчик на событие построения маршрута.
                    route.model.events.add('requestsuccess', function () {

                        var activeRoute = route.getActiveRoute();
                        if (activeRoute) {
                            // Получим протяженность маршрута.
                            var length = route.getActiveRoute().properties.get("distance"),
                                // Вычислим стоимость доставки.
                                price = calculate(Math.round(length.value / 1000)),
                                // Создадим макет содержимого балуна маршрута.
                                balloonContentLayout = ymaps.templateLayoutFactory.createClass(
                                    '<span>Расстояние: ' + length.text + '.</span><br/>' +
                                    '<span style="font-weight: bold; font-style: italic">Стоимость доставки: ' + price + ' р.</span>');
                            // Зададим этот макет для содержимого балуна.
                            route.options.set('routeBalloonContentLayout', balloonContentLayout);
                            // Откроем балун.
                            activeRoute.balloon.open();
                        }
                    });

                });

                // Функция, вычисляющая стоимость доставки.
                function calculate(routeLength) {
                    return Math.max(routeLength * DELIVERY_TARIFF, MINIMUM_COST);
                }
            }
        },
        mounted() {
            ymaps.ready(this.init)
        }
    }
    Vue.createApp(Yandex_map).mount('#order_form')
</script>